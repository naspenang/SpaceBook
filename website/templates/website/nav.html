{% load static %}
<nav class="navbar navbar-expand-lg navbar-dark bg-dark mb-0">
  <div class="container-fluid">
    <a class="navbar-brand" href="/">
      <img
        src="{% static 'images/logo.png' %}"
        style="height: 30px; margin-top: -5px"
        alt="SpaceBook logo"
      />
      SpaceBook
    </a>

    <button
      class="navbar-toggler"
      type="button"
      data-bs-toggle="collapse"
      data-bs-target="#mainNav"
    >
      <span class="navbar-toggler-icon"></span>
    </button>

    <div class="collapse navbar-collapse" id="mainNav">
      <ul class="navbar-nav ms-auto mb-2 mb-lg-0">

        {% if user.is_authenticated %}
          <!-- Profile dropdown when logged in -->
          <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle"
              href="#"
              id="profileDropdown"
              role="button"
              data-bs-toggle="dropdown"
              aria-expanded="false">

              {% if google_picture %}
                <img src="{{ google_picture }}"
                    class="rounded-circle me-2"
                    style="width:32px; height:32px; object-fit:cover; border:2px solid #fff;">
              {% else %}
                <i class="bi bi-person-circle me-1"></i>
              {% endif %}

              <span class="d-none d-lg-inline">{{ user.get_full_name }}</span>
              <span class="d-lg-none">{{ user.first_name }}</span>
            </a>

            <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="profileDropdown">
              <li><a class="dropdown-item" href="{% url 'profile' %}">Profile</a></li>
              <li><hr class="dropdown-divider"></li>
              <li>
                <form action="{% url 'logout' %}" method="post" class="px-3 py-1">
                  {% csrf_token %}
                  <button type="submit" class="dropdown-item">Logout</button>
                </form>
              </li>
            </ul>
          </li>
        {% else %}
          <!-- Google login button -->
          <li class="nav-item">
            <a class="nav-link" href="{% url 'social:begin' 'google-oauth2' %}">
              Login with Google
            </a>
          </li>
        {% endif %}

      </ul>
    </div>
  </div>
</nav>
